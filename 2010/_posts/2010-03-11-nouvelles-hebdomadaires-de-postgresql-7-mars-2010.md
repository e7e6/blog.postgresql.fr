---
layout: post
title: "Nouvelles hebdomadaires de PostgreSQL - 7 mars 2010"
author: "chl"
categories: [PostgreSQL Weekly News]
redirect_from: "index.php?post/2010/03/11/Nouvelles-hebdomadaires-de-PostgreSQL-7-mars-2010"
---


<p>Des mises &agrave; jour pour cause de bug seront publi&eacute;es bient&ocirc;t, concernant toutes les versions de la 7.4 &agrave; la 8.4. Pr&eacute;parez-vous&nbsp;!</p>

<p>Le PUG de San Francisco fera une "F&ecirc;te du Test" le samedi 3 avril de 11h &agrave; 18h. Vid&eacute;o en direct. Aidez &agrave; en faire un &eacute;v&eacute;nement mondial&nbsp;! 

<a target="_blank" href="http://wiki.postgresql.org/wiki/SFPUG_Beta_Test_Day">http://wiki.postgresql.org/wiki/SFPUG_Beta_Test_Day</a></p>

<p>Le programme de la PGCon 2010 est maintenant disponible&nbsp;: 

<a target="_blank" href="http://www.pgcon.org/2010/schedule/">http://www.pgcon.org/2010/schedule/</a></p>

<p>PostgreSQLfr tiendra un stand lors des Solutions Linux 2010 &agrave; Paris (16-18 mars, Porte de Versailles). Volontaires, n'h&eacute;sitez pas &agrave; contacter St&eacute;phane Schildknecht &agrave; l'adresse sas CHEZ postgresql POINT fr, ou sur la liste g&eacute;n&eacute;rale&nbsp;: bureau CHEZ postgresql POINT fr. Plus d'informations sur l'&eacute;v&eacute;nement&nbsp;: 

<a target="_blank" href="http://www.solutionslinux.fr">http://www.solutionslinux.fr</a></p>

<p><strong>Les nouveaut&eacute;s des produits d&eacute;riv&eacute;s</strong></p>

<ul>

<li>MicroOLAP Database Designer 1.2.10 pour PostgreSQL&nbsp;: 

<a target="_blank" href="http://microolap.com/products/database/postgresql-designer/">http://microolap.com/products/database/postgresql-designer/</a></li>

</ul>

<p><strong>La fonctionnalit&eacute; 9.0 de la semaine</strong></p>

<p>La sortie de EXPLAIN peut &ecirc;tre format&eacute;e en XML, JSON et YAML, facilitant la lecture par un programme. Le format texte traditionnel reste celui par d&eacute;faut.</p>

<p><strong>PostgreSQL Local</strong></p>

<ul>

<li>Le BWPUG [ndt: Baltimore/Washington PUG] se r&eacute;unira &agrave; Falls Church (Virginie, &Eacute;tats-Unis) le 10 mars &agrave; 18h30&nbsp;: 

<a target="_blank" href="http://www.xzilla.net/blog/2010/Feb/BWPUG-March-10th,-Falls-Church-take-two..html">http://www.xzilla.net/blog/2010/Feb/BWPUG-March-10th,-Falls-Church-take-two..html</a></li>

<li>Le PUG allemand aura un stand aux Linuxdays de Chemnitz les 13 et 14 mars 2010. Andreas (ads) Scherbaum y donnera une conf&eacute;rence sur PostgreSQL 9.0 et dirigera un atelier sur la configuration de PostgreSQL&nbsp;: 

<a target="_blank" href="http://andreas.scherbaum.la/blog/archives/652-PostgreSQL-stand-at-Chemnitz-Linux-Days-2010.html">http://andreas.scherbaum.la/blog/archives/652-PostgreSQL-stand-at-Chemnitz-Linux-Days-2010.html</a> <a target="_blank" href="http://chemnitzer.linux-tage.de/2010/vortraege/plan.html">http://chemnitzer.linux-tage.de/2010/vortraege/plan.html</a></li>

<li>La "JDCon East" aura lieu &agrave; Philadelphie (Pennsylvanie, &Eacute;tats-Unis) du 25 au 28 mars 2010&nbsp;: 

<a target="_blank" href="http://www.postgresqlconference.org/2010/east">http://www.postgresqlconference.org/2010/east</a></li>

<li>La "Linuxfest Northwest 2010" aura lieu &agrave; Bellingham, Washington, &Eacute;tats-Unis les 24 et 25 avril. Conf&eacute;rences, r&eacute;unions et m&eacute;c&eacute;nat sont proposables&nbsp;: 

<a target="_blank" href="http://linuxfestnorthwest.org/">http://linuxfestnorthwest.org/</a></li>

<li>Andreas (ads) Scherbaum enseignera au centre pour adultes de Magdeburg (All.) du 3 au 7 mai 2010 sur le sujet "PostgreSQL for Corporate Use". D&eacute;tails ci-dessous&nbsp;: 

<a target="_blank" href="http://andreas.scherbaum.la/blog/archives/650-PostgreSQL-Schulung-als-Bildungsurlaub-03.-07.05.2010-in-Magdeburg.html">http://andreas.scherbaum.la/blog/archives/650-PostgreSQL-Schulung-als-Bildungsurlaub-03.-07.05.2010-in-Magdeburg.html</a></li>

<li>La PgCon 2010 aura lieu les 20 &amp; 21 mai 2010 &agrave; Ottawa avec des tutoriels les 18 et 19. L'appel &agrave; conf&eacute;renciers est lanc&eacute;&nbsp;! 

<a target="_blank" href="http://www.pgcon.org/2010/registration.php">http://www.pgcon.org/2010/registration.php</a></li>

<li>L'appel aux conf&eacute;renciers pour l'OSBridge est lanc&eacute;&nbsp;! L'&eacute;v&eacute;nement aura lieu du 1er au 4 juin 2010 &agrave; Portland (Oregon)&nbsp;: 

<a target="_blank" href="http://opensourcebridge.org/events/2010/proposals/">http://opensourcebridge.org/events/2010/proposals/</a></li>

<li>L'OSCON aura lieu &agrave; Portland (Oregon) du 19 au 23 juillet 2010&nbsp;: 

<a target="_blank" href="http://www.oscon.com/oscon2010">http://www.oscon.com/oscon2010</a></li>

</ul>

<p><strong>PostgreSQL dans les m&eacute;dia</strong></p>

<ul>

<li>Planet PostgreSQL&nbsp;: 

<a target="_blank" href="http://planet.postgresql.org/">http://planet.postgresql.org/</a></li>

<li>Planet PostgreSQLFr&nbsp;: 

<a target="_blank" href="http://planete.postgresql.fr/">http://planete.postgresql.fr/</a></li>

</ul>

<p><i>PostgreSQL Weekly News / les nouvelles hebdomadaires vous sont offertes cette semaine par David Fetter. Traduction par l'&eacute;quipe PostgreSQLFr sous licence CC BY-NC-SA.</i></p>

<p><i>Proposez vos articles ou annonces avant dimanche 15:00 (heure du Pacifique). Merci de les envoyer en anglais &agrave; david (a) fetter.org, en allemand &agrave; pwn (a) pgug.de, en italien &agrave; pwn (a) itpug.org.</i></p>

<p>(<a target="_blank" href="http://www.postgresql.org/community/weeklynews/pwn20100307">lien vers l'article original</a>)</p>

<!--more-->


<p><strong>Correctifs appliqu&eacute;s</strong></p>

<p>Tom Lane a commit&eacute;&nbsp;:</p>

<ul>

<li>Back-patch today's memory management fixups in contrib/xml2. Prior to 8.3, these changes are not critical for compatibility with core Postgres, since core had no libxml2 calls then. However there is still a risk if contrib/xml2 is used along with libxml2 functionality in Perl or other loadable modules. So back-patch to all versions. Also back-patch addition of regression tests. I'm not sure how many of the cases are interesting without the interaction with core xml code, but a silly regression test is still better than none at all.</li>

<li>Remove xmlCleanupParser calls from contrib/xml2. These are unnecessary and probably dangerous. I don't see any immediate risk situations in the core XML support or contrib/xml2 itself, but there could be issues with external uses of libxml2, and in any case it's an accident waiting to happen.</li>

<li>In pgsql/src/port/copydir.c, buildfarm still unhappy, so I'll bet it's EACCES not EPERM.</li>

<li>Fix contrib/xml2 so regression test still works when it's built without libxslt. This involves modifying the module to have a stable ABI, that is, the xslt_process() function still exists even without libxslt. It throws a runtime error if called, but doesn't prevent executing the CREATE FUNCTION call. This is a good thing anyway to simplify cross-version upgrades.</li>

<li>In pgsql/src/pl/plpgsql/src/gram.y, cause plpgsql to throw an error if "INTO rowtype_var" is followed by a comma. Per bug #5352, this helps to provide a useful error message if the user tries to do something presently unsupported, namely use a rowtype variable as a member of a multiple-item INTO list.</li>

<li>In pgsql/src/pl/plpgsql/src/gram.y, instead of trying (and failing) to allow &lt;&lt;label&gt;&gt; at the end of a DECLARE section, throw an error message saying explicitly that the label must go before DECLARE. Per investigation of a recent pgsql-novice question, this code did not work as intended in any modern PG version, maybe not ever. Allowing such a thing would only create ambiguity anyway, so it seems better to remove it than fix it.</li>

<li>Export xml.c's libxml-error-handling support so that contrib/xml2 can use it too, instead of duplicating the functionality (badly). I renamed xml_init to pg_xml_init, because the former seemed just a bit too generic to be safe as a global symbol. I considered likewise renaming xml_ereport to pg_xml_ereport, but felt that the reference to ereport probably made it sufficiently PG-centric already.</li>

<li>Make contrib/xml2 use core xml.c's error handler, when available (that is, in versions &gt;= 8.3). The core code is more robust and efficient than what was there before, and this also reduces risks involved in swapping different libxml error handler settings. Before 8.3, there is still some risk of problems if add-on modules such as Perl invoke libxml without setting their own error handler. Given the lack of reports I'm not sure there's a risk in practice, so I didn't take the step of actually duplicating the core code into older contrib/xml2 branches. Instead I just tweaked the existing code to ensure it didn't leave a dangling pointer to short-lived memory when throwing an error.</li>

<li>Fix a couple of places that would loop forever if attempts to read a stdio file set ferror() but never set feof(). This is known to be the case for recent glibc when trying to read a directory as a file, and might be true for other platforms/cases too. Per report from Ed L. (There is more that we ought to do about his report, but this is one easily identifiable issue.)</li>

<li>In pgsql/src/backend/libpq/hba.c, when reading pg_hba.conf and similar files, do not treat @file as an inclusion unless (1) the @ isn't quoted and (2) the filename isn't empty. This guards against unexpectedly treating usernames or other strings in "flat files" as inclusion requests, as seen in a recent trouble report from Ed L. The empty-filename case would be guaranteed to misbehave anyway, because our subsequent path-munging behavior results in trying to read the directory containing the current input file. I think this might finally explain the report at 

<a target="_blank" href="http://archives.postgresql.org/pgsql-bugs/2004-05/msg00132.php">http://archives.postgresql.org/pgsql-bugs/2004-05/msg00132.php</a> of a crash after printing "authentication file token too long, skipping", since I was able to duplicate that message (though not a crash) on a platform where stdio doesn't refuse to read directories. We never got far in investigating that problem, but now I'm suspicious that the trigger condition was an @ in the flat password file. Back-patch to all active branches since the problem can be demonstrated in all branches except HEAD. The test case, creating a user named "@", doesn't cause a problem in HEAD since we got rid of the flat password file. Nonetheless it seems like a good idea to not consider quoted @ as a file inclusion spec, so I changed HEAD too.</li>

<li>In pgsql/src/backend/catalog/aclchk.c, fix warning messages in restrict_and_check_grant() to include the column name when warning about column-level privileges. This is more useful than before and makes the apparent duplication complained of by Piyush Newe not so duplicate. Also fix lack of quote marks in a related message text. Back-patch to 8.4, where column-level privileges were introduced. Stephen Frost</li>

<li>Update time zone data files to tzdata release 2010c: DST law changes in Bangladesh, Mexico, Paraguay.</li>

</ul>

<p>Magnus Hagander a commit&eacute;&nbsp;:</p>

<ul>

<li>In pgsql/src/backend/libpq/hba.c, it's clearly now pointless to do backwards compatible parsing of this, since we released a version without it, so remove the comment that says we might want to do that.</li>

<li>Add --psqlrc=FILENAME parameter to psql, to process an explicitly named file instead of ~/.psqlrc on startup.</li>

<li>Revert patch for --psqlrc=FILENAME in psql.</li>

</ul>

<p>Heikki Linnakangas a commit&eacute;&nbsp;:</p>

<ul>

<li>Fix numericlocale psql option when used with a null string and latex and troff formats; a null string must not be formatted as a numeric. The more exotic formats latex and troff also incorrectly formatted all strings as numerics when numericlocale was on. Backpatch to 8.1 where numericlocale option was added. This fixes bug #5355 reported by Andy Lester.</li>

<li>In pgsql/src/bin/psql/print.c, fix translation of strings in psql \d output (translation in headers worked, but not in cells).</li>

<li>Fix pg_dump of ACLs of foreign servers. The command to grant/revoke privileges of foreign servers is "GRANT ... ON *FOREIGN* SERVER ...".</li>

<li>In pgsql/src/backend/parser/parse_coerce.c, fix IsBinaryCoercible to not confuse a cast using in/out functions with binary compatibility. Backpatch to 8.4 where INOUT casts were introduced.</li>

</ul>

<p>Andrew Dunstan a commit&eacute;&nbsp;:</p>

<ul>

<li>In pgsql/src/tools/msvc/Solution.pm, add XSLT defines for MSVC builds.</li>

<li>In pgsql/src/tools/msvc/Solution.pm, backpatch MSVC build fix for XSLT.</li>

<li>In pgsql/src/tools/msvc/vcregress.pl, do not run regression tests for contrib/xml2 on MSVC unless building with XML.</li>

<li>In pgsql/src/tools/msvc/Solution.pm, add missing library and include dir for XSLT in MSVC builds.</li>

<li>In pgsql/src/tools/msvc/Solution.pm, make iconv work like other optional libraries for MSVC.</li>

</ul>

<p>Peter Eisentraut a commit&eacute;&nbsp;:</p>

<ul>

<li>In pgsql/doc/src/sgml/keywords.sgml, update keywords list for 9.0.</li>

</ul>

<p>Bruce Momjian a commit&eacute;&nbsp;:</p>

<ul>

<li>Document the effect of max_standby_delay on increasing the delay of data from master to slave, and discourage its use during slave/master keep-xid-alive connections.</li>

<li>In pgsql/doc/src/sgml/config.sgml, adjust max_standby_delay documentation to be clearer, and mention that two adjacent long-running queries have much less than max_standby_delay before query cancel is possible.</li>

<li>In pgsql/src/backend/utils/adt/xml.c, pgindent run on xml.c in 8.3 branch, per request from Tom Lane.</li>

<li>In pgsql/doc/src/sgml/ref/create_function.sgml, restructure CREATE FUNCTION "NOTES" section to be shorter; move items into proper sections, per suggestion from Tom Lane.</li>

<li>In pgsql/doc/src/sgml/ref/create_function.sgml, fix SGML markup.</li>

<li>Document that "Q" is ignored by to_date and to_timestamp. Add C comment about the behavior. Document that quotes in to_date, to_timestamp, to_number skip input characters.</li>

<li>In pgsql/src/bin/pg_dump/pg_dump.c, add C comment about DDL changes possibly causing pg_dump errors.</li>

</ul>

<p>Michael Meskes a commit&eacute;&nbsp;:</p>

<ul>

<li>In case the connection magically disappears libecpg only returns an internal error sqlstate. This change makes it return a correct value.</li>

</ul>

<p><strong>Correctifs rejet&eacute;s (&agrave; ce jour)</strong></p>

<ul>

<li>Pas de d&eacute;ception cette semaine&nbsp;:-)</li>

</ul>

<p><strong>Correctifs en attente</strong></p>

<ul>

<li>Magnus Hagander sent in a patch to fix a crash issue with psql and GSS auth.</li>

<li>Bruce Momjian sent in another revision of a patch to fix some issues with to_char() on Windows.</li>

<li>Fujii Masao sent in three more patches to help fix corner cases in streaming replication with pg_xlogfile_name().</li>

<li>Fujii Masao sent in a patch to mandate setting either restore_command or primary_conninfo in recovery.conf.</li>

<li>Fujii Masao sent in a patch to correct recovery.conf.sample for streaming replication.</li>

<li>KaiGai Kohei sent in a patch to disallow renaming columns in sequence "tables."</li>

<li>Bruce Momjian sent in three patches fixing to_timestamp() behavior with 'Q'.</li>

<li>KaiGai Kohei sent in a patch factoring out duplicate code in CreateOpFamily() and DefineOpFamily().</li>

<li>Tim Bunce sent in a patch to fix a core dump in PL/Perl installcheck with bleadperl.</li>

<li>Bruce Momjian sent in three revisions of a patch to fix the exit code form psql -1 when it encounters a violation of a deferred foreign key constraint.</li>

</ul>